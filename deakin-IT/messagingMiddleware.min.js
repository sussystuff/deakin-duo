/*!
 * messenger
 * @version: 2.4.16
 * @license: Genesys Telecom Labs
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.messagingMiddleware=t():e.messagingMiddleware=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(e,t,n){"use strict";n.r(t),n.d(t,"connect",(function(){return r})),n.d(t,"connecting",(function(){return i})),n.d(t,"reconnect",(function(){return d})),n.d(t,"reconnecting",(function(){return o})),n.d(t,"connected",(function(){return a})),n.d(t,"reconnected",(function(){return c})),n.d(t,"disconnect",(function(){return s})),n.d(t,"disconnected",(function(){return u})),n.d(t,"pending",(function(){return p})),n.d(t,"readyToSend",(function(){return f})),n.d(t,"restored",(function(){return E})),n.d(t,"restoring",(function(){return l})),n.d(t,"reopen",(function(){return g})),n.d(t,"restoreAuthSession",(function(){return y})),n.d(t,"fetchHistory",(function(){return S})),n.d(t,"fetchingHistory",(function(){return T})),n.d(t,"historyFetched",(function(){return h})),n.d(t,"historyComplete",(function(){return m})),n.d(t,"requestUpload",(function(){return N})),n.d(t,"requestingUpload",(function(){return O})),n.d(t,"uploadApproved",(function(){return C})),n.d(t,"uploadFile",(function(){return F})),n.d(t,"fileUploading",(function(){return I})),n.d(t,"fileUploaded",(function(){return D})),n.d(t,"fileUploadFailed",(function(){return R})),n.d(t,"fileDownloadError",(function(){return v})),n.d(t,"getFile",(function(){return A})),n.d(t,"refreshFiles",(function(){return L})),n.d(t,"refreshingFiles",(function(){return M})),n.d(t,"requestingFile",(function(){return U})),n.d(t,"messagesUpdated",(function(){return b})),n.d(t,"deleteFile",(function(){return P})),n.d(t,"fileDeleted",(function(){return H})),n.d(t,"downloadFile",(function(){return w})),n.d(t,"send",(function(){return G})),n.d(t,"sending",(function(){return k})),n.d(t,"sendTextBack",(function(){return x})),n.d(t,"sendingTextBack",(function(){return j})),n.d(t,"sendTyping",(function(){return Y})),n.d(t,"received",(function(){return _})),n.d(t,"receivedTyping",(function(){return V})),n.d(t,"resetTyping",(function(){return B})),n.d(t,"clearTypingTimeout",(function(){return q})),n.d(t,"userTyping",(function(){return W})),n.d(t,"addMessages",(function(){return K})),n.d(t,"end",(function(){return Q})),n.d(t,"ended",(function(){return X})),n.d(t,"closed",(function(){return z})),n.d(t,"openWithStore",(function(){return J})),n.d(t,"logout",(function(){return Z})),n.d(t,"reAuthenticate",(function(){return $})),n.d(t,"error",(function(){return ee})),n.d(t,"startFailed",(function(){return te})),n.d(t,"sendFailed",(function(){return ne})),n.d(t,"restoreFailed",(function(){return re})),n.d(t,"offline",(function(){return ie})),n.d(t,"sessionExpired",(function(){return de})),n.d(t,"fetchHistoryFailed",(function(){return oe})),n.d(t,"clearSession",(function(){return ae})),n.d(t,"resetConversation",(function(){return ce})),n.d(t,"sessionCleared",(function(){return se})),n.d(t,"connectionClosed",(function(){return ue})),n.d(t,"readOnly",(function(){return pe})),n.d(t,"conversationNotFound",(function(){return fe}));const r=e=>({type:"CONNECT",data:e}),i=()=>({type:"CONNECTING"}),d=()=>({type:"RECONNECT"}),o=e=>({type:"RECONNECTING",data:e}),a=e=>({type:"CONNECTED",data:e}),c=e=>({type:"RECONNECTED",data:e}),s=()=>({type:"DISCONNECT"}),u=e=>({type:"DISCONNECTED",data:e}),p=()=>({type:"PENDING"}),f=()=>({type:"READYTOSEND"}),E=e=>({type:"RESTORED",data:e}),l=()=>({type:"RESTORING"}),g=e=>({type:"REOPEN",data:e}),y=()=>({type:"RESTOREAUTHSESSION"}),S=()=>({type:"FETCHHISTORY"}),T=()=>({type:"FETCHINGHISTORY"}),h=e=>({type:"HISTORYFETCHED",data:e}),m=()=>({type:"HISTORYCOMPLETE"}),N=e=>({type:"REQUESTUPLOAD",data:e}),O=e=>({type:"REQUESTINGUPLOAD",data:e}),C=e=>({type:"UPLOADAPPROVED",data:e}),F=e=>({type:"UPLOADFILE",data:e}),I=e=>({type:"FILEUPLOADING",data:e}),D=e=>({type:"FILEUPLOADED",data:e}),R=e=>({type:"FILEUPLOADFAILED",data:e}),v=e=>({type:"FILEDOWNLOADERROR",data:e}),A=e=>({type:"GETFILE",data:e}),L=e=>({type:"REFRESHFILES",data:e}),M=e=>({type:"REFRESHINGFILES",data:e}),U=e=>({type:"REQUESTINGFILE",data:e}),b=e=>({type:"MESSAGESUPDATED",data:e}),P=e=>({type:"DELETEFILE",data:e}),H=e=>({type:"FILEDELETED",data:e}),w=e=>({type:"DOWNLOADFILE",data:e}),G=e=>({type:"SEND",data:e}),k=()=>({type:"SENDING"}),x=e=>({type:"SENDTEXTBACK",data:e}),j=()=>({type:"SENDINGTEXTBACK"}),Y=()=>({type:"SENDTYPING"}),_=e=>({type:"RECEIVED",data:e}),V=e=>({type:"RECEIVEDTYPING",data:e}),B=()=>({type:"RESETTYPING"}),q=()=>({type:"CLEARTYPINGTIMEOUT"}),W=()=>({type:"USERTYPING"}),K=e=>({type:"ADDMESSAGES",data:e}),Q=e=>({type:"END",data:e}),X=e=>({type:"ENDED",data:e}),z=()=>({type:"CLOSED"}),J=e=>({type:"OPEN-WITH-STORE",data:e}),Z=()=>({type:"LOGOUT"}),$=()=>({type:"REAUTHENTICATE"}),ee=e=>({type:"ERROR",data:e}),te=e=>({type:"STARTFAILED",data:e}),ne=e=>({type:"SENDFAILED",data:e}),re=e=>({type:"RESTOREFAILED",data:e}),ie=e=>({type:"OFFLINE",data:e}),de=e=>({type:"SESSIONEXPIRED",data:e}),oe=e=>({type:"FETCHHISTORYFAILED",data:e}),ae=e=>({type:"CLEARSESSION",data:e}),ce=e=>({type:"RESETCONVERSATION"}),se=e=>({type:"SESSIONCLEARED",data:e}),ue=()=>({type:"CONNECTIONCLOSED"}),pe=e=>({type:"READONLY",data:e}),fe=()=>({type:"CONVERSATIONNOTFOUND"})},function(e,t,n){"use strict";function r(e){return{type:"CONFIRM_CHAT",route:e.route}}function i(e){return{type:"OPEN_CONVERSATIONS",route:e.route}}function d(){return{type:"NAVIGATE_BACK"}}function o(){return{type:"NAVIGATE_TO_HOME"}}n.r(t),n.d(t,"confirmChat",(function(){return r})),n.d(t,"openConversations",(function(){return i})),n.d(t,"navigateBack",(function(){return d})),n.d(t,"navigateToHome",(function(){return o})),n.d(t,"setConfig",(function(){return c})),n.d(t,"getConfig",(function(){return s}));let a={};function c(e){e&&(a=e)}function s(){return a}},function(e,t,n){e.exports=n},function(e,t,n){"use strict";n.r(t),n.d(t,"onMessage",(function(){return d})),n.d(t,"onTyping",(function(){return o})),n.d(t,"onTypingTimeout",(function(){return a})),n.d(t,"onReadyToSend",(function(){return c})),n.d(t,"onStarting",(function(){return s})),n.d(t,"onStart",(function(){return u})),n.d(t,"onEnd",(function(){return p})),n.d(t,"onDisconnect",(function(){return f})),n.d(t,"onError",(function(){return E})),n.d(t,"onStartFailed",(function(){return l})),n.d(t,"onSendFailed",(function(){return g})),n.d(t,"onSessionExpired",(function(){return y})),n.d(t,"onSessionCleared",(function(){return S})),n.d(t,"onFetchHistoryFailed",(function(){return T})),n.d(t,"onRestoring",(function(){return h})),n.d(t,"onRestoreFailed",(function(){return m})),n.d(t,"onRestored",(function(){return N})),n.d(t,"onFetchingHistory",(function(){return O})),n.d(t,"onHistoryFetched",(function(){return C})),n.d(t,"onHistoryComplete",(function(){return F})),n.d(t,"onReconnecting",(function(){return I})),n.d(t,"onReopen",(function(){return D})),n.d(t,"onConnectionClosed",(function(){return R})),n.d(t,"onOffline",(function(){return v})),n.d(t,"onReconnected",(function(){return A})),n.d(t,"onUploadApproved",(function(){return L})),n.d(t,"onFileUploaded",(function(){return M})),n.d(t,"onFileUploadFailed",(function(){return U})),n.d(t,"onFileDownloadError",(function(){return b})),n.d(t,"onFileUploading",(function(){return P})),n.d(t,"onFileDeleted",(function(){return H})),n.d(t,"onMessagesUpdated",(function(){return w})),n.d(t,"onLogout",(function(){return G})),n.d(t,"onReauthenticate",(function(){return k})),n.d(t,"onReadOnly",(function(){return x})),n.d(t,"onSessionReset",(function(){return j})),n.d(t,"onConversationNotFound",(function(){return Y}));var r=n(0),i=n(1);let d=()=>{},o=()=>{},a=()=>{},c=()=>{},s=()=>{},u=()=>{},p=()=>{},f=()=>{},E=()=>{},l=()=>{},g=()=>{},y=()=>{},S=()=>{},T=()=>{},h=()=>{},m=()=>{},N=()=>{},O=()=>{},C=()=>{},F=()=>{},I=()=>{},D=()=>{},R=()=>{},v=()=>{},A=()=>{},L=()=>{},M=()=>{},U=()=>{},b=()=>{},P=()=>{},H=()=>{},w=()=>{},G=()=>{},k=()=>{},x=()=>{},j=()=>{},Y=()=>{};t.default=(()=>{let e="",t=!1,n={},j={},_=!1;return Genesys("registerPlugin","MessagingMiddleware",(function(n){e=n;const d=e=>{const{text:t,messageType:n,type:r,timestamp:i,originatingEntity:d,id:o,...a}=e||{};return{id:o||Math.round(1e6*Math.random()),messageType:n,originatingEntity:d||"",text:t,timestamp:i||Date().toString(),type:r,...a}};e.registerCommand("addMessages",(function(e){let t=i.getConfig(),{preview:n}=t;if(n)if(e.data){if(Array.isArray(e.data)){const t=[];e.data.forEach(e=>{t.push(d(e))}),j.dispatch(r.connected()),j.dispatch(r.addMessages(t)),e.resolve()}else if("object"==typeof e.data){const t=d(e.data);j.dispatch(r.connected()),j.dispatch(r.received(t||e.data.message)),e.resolve()}}else e.reject("No messages to add");else e.reject("Command is allowed only in preview mode.")})),e.registerCommand("updateMessages",(function(e){let t=i.getConfig(),{preview:n}=t;if(n)if(e.data){if(Array.isArray(e.data)){const t=[];e.data.forEach(e=>{e={...e,updatedTime:(new Date).toISOString()},t.push(d(e))}),j.dispatch(r.connected()),j.dispatch(r.messagesUpdated({updatedMessages:t})),e.resolve()}else if("object"==typeof e.data){let t=d(e.data);t={...t,updatedTime:(new Date).toISOString()},j.dispatch(r.connected()),j.dispatch(r.messagesUpdated({updatedMessages:[t||{...e.data,updatedTime:(new Date).toISOString()}]})),e.resolve()}}else e.reject("No messages to add");else e.reject("Command is allowed only in preview mode.")})),e.registerCommand("clear",(function(e){let t=i.getConfig(),{preview:n}=t;n?(j.dispatch(r.sessionCleared({messages:[]})),e.resolve()):e.reject("Command only allowed in preview mode")})),e.subscribe("MessagingPreview.ready",()=>{t=!0}),_||(e.ready(),_=!0)})),V=>B=>q=>{j=V,s=e=>{V.dispatch(r.connecting(e))},h=()=>{V.dispatch(r.restoring())},N=e=>{V.dispatch(r.restored(e))},O=()=>{V.dispatch(r.fetchingHistory())},C=e=>{V.dispatch(r.historyFetched(e))},F=()=>{V.dispatch(r.historyComplete())},l=e=>{V.dispatch(r.startFailed(e))},y=()=>{V.dispatch(r.sessionExpired())},T=e=>{V.dispatch(r.fetchHistoryFailed(e))},g=e=>{V.dispatch(r.sendFailed(e))},U=e=>{V.dispatch(r.fileUploadFailed(e))},b=e=>{V.dispatch(r.fileDownloadError(e))},P=e=>{V.dispatch(r.fileUploading(e))},M=e=>{V.dispatch(r.fileUploaded(e))},w=e=>{V.dispatch(r.messagesUpdated(e))},H=e=>{V.dispatch(r.fileDeleted(e))},m=e=>{V.dispatch(r.restoreFailed(e))},v=e=>{V.dispatch(r.offline(e))},A=e=>{V.dispatch(r.reconnected(e))},I=e=>{V.dispatch(r.reconnecting(e))},R=()=>{V.dispatch(r.connectionClosed())},E=e=>{V.dispatch(r.error(e))},d=e=>{e&&e.messages&&V.dispatch(r.received(e.messages))},o=e=>{e&&e.typing&&V.dispatch(r.receivedTyping(e.typing))},a=()=>{V.dispatch(r.resetTyping())},c=()=>{V.dispatch(r.readyToSend())},u=e=>{V.dispatch(r.connected(e))},S=e=>{V.dispatch(r.sessionCleared(e))},D=e=>{V.dispatch(r.reopen(e))},G=()=>{V.dispatch(r.logout())},k=()=>{V.dispatch(r.reAuthenticate())},x=e=>{V.dispatch(r.readOnly(e))},f=e=>{V.dispatch(r.disconnected(e))},Y=()=>{V.dispatch(r.conversationNotFound())},n=i.getConfig();const{preview:W}=n||{};switch(e&&!_&&(e.ready(),_=!0),q.type){case"CONNECT":if(!W){let t=i.getConfig(),{preview:n}=t;n?V.dispatch(r.connected()):e.command("MessagingService.startConversation",q.data)}break;case"RECONNECT":if(!W){let t=i.getConfig(),{preview:n}=t;n?V.dispatch(r.reconnected()):e.command("MessagingService.reconnect")}break;case"SEND":W&&t?e.command("MessagingPreview.sendMessage",q.data).then(e=>{V.dispatch(r.received(e))}):(V.dispatch(r.sending()),e.command("MessagingService.sendMessage",q.data));break;case"SENDTEXTBACK":W&&t?e.command("MessagingPreview.sendMessage",q.data).then(e=>{V.dispatch(r.received(e))}):(V.dispatch(r.sendingTextBack()),e.command("MessagingService.sendMessage",q.data));break;case"SENDTYPING":V.dispatch(r.userTyping()),W||e.command("MessagingService.sendTyping");break;case"CLEARTYPINGTIMEOUT":V.dispatch(r.resetTyping()),W||e.command("MessagingService.clearTypingTimeout");break;case"REQUESTUPLOAD":W||(L=e=>{e&&V.dispatch(r.uploadApproved(e))},V.dispatch(r.requestingUpload(q.data)),e.command("MessagingService.requestUpload",{file:q.data}));break;case"UPLOADFILE":W||(V.dispatch(r.fileUploading()),e.command("MessagingService.uploadFile",q.data));break;case"DELETEFILE":W||e.command("MessagingService.deleteFile",q.data);break;case"GETFILE":W||(V.dispatch(r.requestingFile()),e.command("MessagingService.getFile",q.data));break;case"REFRESHFILES":W||(V.dispatch(r.refreshingFiles()),e.command("MessagingService.refreshFiles",{files:q.data}));break;case"END":W||(p=e=>{V.dispatch(r.ended(e))},e.command("MessagingService.endConversation"));break;case"CLEARSESSION":e.command("MessagingService.clearSession",q.data);break;case"RESETCONVERSATION":e.command("MessagingService.resetConversation",q.data);break;case"FETCHHISTORY":W||(C=e=>{V.dispatch(r.historyFetched(e))},e&&e.command("MessagingService.fetchHistory"));break;case"DOWNLOADFILE":W||e.command("MessagingService.downloadFile",q.data);break;case"RESTOREAUTHSESSION":W||e.command("MessagingService.restoreAuthSession");break;default:return B(q)}}})()}])}));